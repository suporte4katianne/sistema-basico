<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	template="/WEB-INF/template/Layout.xhtml">


	<ui:define name="content">
		<f:metadata>
			<f:viewAction action="#{notaFiscalFormularioBean.inicializar()}" />
			<o:viewParam name="notaFiscal"
				value="#{notaFiscalFormularioBean.notaFiscal}"
				converter="#{notaFiscalConverter}" />
		</f:metadata>

		<h:form id="formNfe">
			<p:tabView id="tabView">
				<p:tab title="Dados do cabeçalho">
					<p:panel header="Dados do Documento Fiscal"
						id="dadosDocumentoFiscal">

						<h:panelGrid columns="4" columnClasses="rotulo, campo">

							<p:outputLabel for="opercao" value="Operação:" />
							<p:selectOneMenu id="opercao"
								value="#{notaFiscalFormularioBean.notaFiscal.operacao}"
								required="true">
								<f:selectItem itemLabel="Selecione..." itemValue="" />
								<f:selectItem itemLabel="1 - Operação Estadual" itemValue="1" />
								<f:selectItem itemLabel="2 - Operação Interestadual"
									itemValue="2" />
								<p:ajax process="opercao" update="cfopCabecalho" event="change"
									listener="#{notaFiscalFormularioBean.carregaCfopPorTipoEOperacao()}" />
							</p:selectOneMenu>


							<p:outputLabel for="tipoNota" value="Movimentação:" />
							<p:selectOneMenu id="tipoNota" disabled="true" style="opacity: 0.8"
								value="#{notaFiscalFormularioBean.notaFiscal.tipoNf}"
								required="true">
								<f:selectItem
									itemLabel="1 - Venda/Saida/Devolução para Fornecedor"
									itemValue="1" />
								<p:ajax process="tipoNota" update="cfopCabecalho" event="change"
									listener="#{notaFiscalFormularioBean.carregaCfopPorTipoEOperacao()}" />
							</p:selectOneMenu>

						</h:panelGrid>

						<h:panelGrid columns="2" columnClasses="rotulo">
							<p:outputLabel for="cfopCabecalho" value="Natureza Operação:" />
							<p:selectOneMenu id="cfopCabecalho" converter="#{cfopConverter}"
											 value="#{notaFiscalFormularioBean.notaFiscal.cfop}" required="true">
								<f:selectItem itemLabel="Selecione..." />
								<f:selectItems value="#{notaFiscalFormularioBean.cfops}"
											   var="dados" itemValue="#{dados}"
											   itemLabel="#{dados.codigo} - #{dados.cfop}" />
								<p:ajax process="cfopCabecalho" update="cfopProduto"
										listener="#{notaFiscalFormularioBean.atualizaCfop()}" />
							</p:selectOneMenu>
						</h:panelGrid>

						<h:panelGrid columns="6" columnClasses="rotulo, campo">

							<p:outputLabel for="modelo" value="Modelo:" rendered="#{notaFiscalFormularioBean.alteracao()}" />
							<p:selectOneMenu id="modelo" converter="#{numeracaoConverter}"
											 rendered="#{notaFiscalFormularioBean.alteracao()}"
											 value="#{notaFiscalFormularioBean.numeracao}">
								<f:selectItem itemValue="" itemLabel="01" />
								<f:selectItems
										value="#{notaFiscalFormularioBean.numeracoes}"
										var="dados" itemValue="#{dados}" itemLabel="#{dados.modelo}" />
								<p:ajax process="modelo, serie, numero" update="serie, numero"
										listener="#{notaFiscalFormularioBean.selecionaNumeracao()}" />
							</p:selectOneMenu>

							<p:outputLabel for="serie" value="Serie:" />
							<p:inputText id="serie" style="opacity:1" disabled="#{notaFiscalFormularioBean.numeracao != null}"
										 value="#{notaFiscalFormularioBean.notaFiscal.serieNota}" />

							<p:outputLabel for="numero" value="Numero da Nota:" />
							<p:inputText id="numero" style="opacity:1" disabled="#{notaFiscalFormularioBean.numeracao != null}"
										 value="#{notaFiscalFormularioBean.notaFiscal.numeroNota}" />

						</h:panelGrid>
					</p:panel>
					<div class="ui-fluid">
						<p:panel header="Dados do Cliente" id="dadosEntidade">
							<h:panelGrid style="width:90%" columns="4"
										 columnClasses="rotulo,campo,rotulo ">
								<p:outputLabel value="Cliente" for="entidade" />
								<h:panelGroup style="display:flex;">
									<p:inputText
											value="#{notaFiscalFormularioBean.notaFiscal.nomeEntidade}"
											style="opacity: 1;" id="entidade" disabled="true" />
									<p:commandButton icon="fa fa-search"
													 styleClass="ui-priority-primary" style="max-width: 30px"
													 type="button" onclick="PF('entidadeDialog').show();" />
								</h:panelGroup>

								<p:ajaxStatus>
									<f:facet name="start">
										<i class="fa fa-spinner fa-pulse fa-fw" >Aguarde...</i>
									</f:facet>
									<f:facet name="complete">
										<p:outputLabel value="" />
									</f:facet>
								</p:ajaxStatus>
								<p:outputLabel value="" />

								<p:outputLabel value="Tipo do Destintário:"
											   for="tipoEntidade" />
								<p:selectOneMenu id="tipoEntidade" style="opacity: 1;"
												 disabled="true"
												 value="#{notaFiscalFormularioBean.notaFiscal.tipoCadastro}">
									<f:selectItem itemLabel="Pessoa Fisica" itemValue="2" />
									<f:selectItem itemLabel="Pessoa Jurídica" itemValue="1" />
									<p:ajax process="tipoEntidade"
											update="cpfCnpj, cpfCnpjLabelEntidade tipoEntidade" />
								</p:selectOneMenu>

								<p:outputLabel value="" />
								<p:outputLabel value="" />

								<p:outputLabel value="Inscrição Estadual:"
											   for="inscricaoEntidade" />
								<p:inputText id="inscricaoEntidade" style="opacity: 1;"
											 disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.inscricaoEstadualEntidade}" />

								<p:outputLabel id="cpfCnpjLabelEntidade"
											   value="#{notaFiscalFormularioBean.notaFiscal.tipoCadastro == '1' ? 'CNPJ:' : 'CPF:'}"
											   for="cpfCnpj" />
								<p:inputMask id="cpfCnpj"
											 mask="#{notaFiscalFormularioBean.notaFiscal.tipoCadastro == '1' ? '99.999.999/9999-99' : '999.999.999-99'}"
											 value="#{notaFiscalFormularioBean.notaFiscal.cpfCnpjEntidade}"
											 immediate="true" style="opacity: 1;" disabled="true" />

								<p:outputLabel value="CEP:" for="cepEntidade" />
								<p:inputMask id="cepEntidade" mask="99999-999"
											 style="opacity: 1;" disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.cepEntidade}" />

								<p:outputLabel value="" />
								<p:outputLabel value="" />

								<p:outputLabel value="Estado:" for="estadoEntidade" />
								<p:inputText id="estadoEntidade"
											 value="#{notaFiscalFormularioBean.notaFiscal.estadoEntidade}"
											 style="opacity: 1;" disabled="true" />

								<p:outputLabel value="Cidade:" for="cidadeEntidade" />
								<p:inputText id="cidadeEntidade"
											 value="#{notaFiscalFormularioBean.notaFiscal.nomeCidadeEntidade}"
											 style="opacity: 1;" disabled="true" />

								<p:outputLabel value="Rua:" for="ruaEntidade" />
								<p:inputText id="ruaEntidade" disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.ruaEntidade}"
											 style="opacity: 1;" />

								<p:outputLabel value="Número" for="numeroEnderecoEntidade" />
								<p:inputText id="numeroEnderecoEntidade" style="opacity: 1;"
											 disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.numeroEntidade}" />

								<p:outputLabel value="Bairro:" for="bairroEntidade" />
								<p:inputText id="bairroEntidade" disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.bairroEntidade}"
											 style="opacity: 1;" />

								<p:outputLabel value="Complemento:"
											   for="complementoEntidade" />
								<p:inputText id="complementoEntidade" style="opacity: 1;"
											 disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.complementoEntidade}" />

								<p:outputLabel value="Telefone:" for="telefoneEntidade" />
								<p:inputMask id="telefoneEntidade" mask="(99) 9999-9999"
											 style="opacity: 1;" disabled="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.telefoneEntidade}" />

							</h:panelGrid>
							<p:messages globalOnly="false" />
						</p:panel>
					</div>
				</p:tab>
				<p:tab title="Produtos">
					<div class="ui-fluid">
						<p:panel header="Dados do Produto" id="dadosProduto">
							<p:messages />
							<h:panelGrid columns="8" style="width:90%;text-align:right"
										 columnClasses="rotulo">
								<p:outputLabel value="Produto:" for="produto" />
								<h:panelGroup style="display:flex;">
									<p:inputText
											value="#{notaFiscalFormularioBean.notaFiscalItem.produto.descricao}"
											style="opacity: 1;" id="produto" disabled="true" />
									<p:commandButton icon="fa fa-search"
													 styleClass="ui-priority-primary" style="max-width: 30px"
													 type="button" onclick="PF('produtoDialog').show();" />
								</h:panelGroup>

								<p:outputLabel value="Quantidade:" for="quantidade" />
								<p:inputText
										value="#{notaFiscalFormularioBean.notaFiscalItem.quantidade}"
										id="quantidade" />

								<p:outputLabel value="Valor:" for="valor" />
								<p:inputText
										value="#{notaFiscalFormularioBean.notaFiscalItem.valorUnitario}"
										id="valor" />

								<p:outputLabel value="Desconto:" for="desconto" />
								<p:inputText
										value="#{notaFiscalFormularioBean.notaFiscalItem.desconto}"
										id="desconto" />
							</h:panelGrid>

							<h:panelGrid columns="2" style="width:90%"
										 columnClasses="rotulo, campo">
								<p:outputLabel value="CFOP: " for="cfopProduto" />
								<p:selectOneMenu id="cfopProduto" converter="#{cfopConverter}"
												 value="#{notaFiscalFormularioBean.notaFiscal.cfop}" required="true">

									<f:selectItem itemLabel="Selecione..." />

									<f:selectItems value="#{notaFiscalFormularioBean.cfops}"
												   var="dados" itemValue="#{dados}"
												   itemLabel="#{dados.codigo} - #{dados.cfop}" />

								</p:selectOneMenu>

								<p:outputLabel value="" />

								<p:commandButton value="Incluir Produto" style="width:20%"
												 action="#{notaFiscalFormularioBean.incluirProduto()}"
												 styleClass="ui-priority-primary" process="dadosProduto, formNfe:tabView:numero"
												 update="dadosProduto, formNfe:tabView:dadosTotais, formNfe:tabView:dadosImpostos" />
							</h:panelGrid>


							<p:dataTable emptyMessage="Nenhum item adicionado." reflow="true"
										 value="#{notaFiscalFormularioBean.notaFiscal.notaFiscalItens}"
										 var="produtoItem" style="margin-top: 15px" id="dadosTabelaProduto"
										 rowKey="produtoItem">

								<p:column headerText="Código" style="width:10%">
									<h:outputText value="#{produtoItem.codProd}" />
								</p:column>

								<p:column headerText="Nome" style="width:60%">
									<h:outputText value="#{produtoItem.nomeProduto}" />
								</p:column>

								<p:column headerText="Qtd." style="width:10%">
									<h:outputText value="#{produtoItem.quantidade}" />
								</p:column>

								<p:column headerText="P. Und." style="width:10%">
									<h:outputText value="#{produtoItem.valorUnitario}" />
								</p:column>

								<p:column headerText="Desc." style="width:10%">
									<h:outputText value="#{produtoItem.desconto}" />
								</p:column>

								<p:column headerText="P. Total" style="width:13%">
									<h:outputText value="#{produtoItem.valorTotal}" />
								</p:column>

								<p:column headerText="CST" style="width:10%">
									<h:outputText value="#{produtoItem.cst.codigo}" />
								</p:column>

								<p:column headerText="PIS/Cofins" style="width:13%">
									<h:outputText value="#{produtoItem.cstPisCofins.codigo}" />
								</p:column>

								<p:column headerText="CFOP" style="width:10%">
									<h:outputText value="#{produtoItem.cfop}" />
								</p:column>

								<p:column headerText="Ações" style="width:10%">
									<p:commandButton icon="fa fa-trash-o"
													 styleClass="ui-priority-primary"
													 actionListener="#{notaFiscalFormularioBean.removerProduto(produtoItem)}"
													 update="dadosTabelaProduto, formNfe:tabView:dadosImpostos, formNfe:tabView:dadosTotais"/>
									<p:commandButton icon="fa fa-pencil"
													 styleClass="ui-priority-primary"
													 actionListener="#{notaFiscalFormularioBean.editarProduto(produtoItem)}"
													 update="dadosTabelaProduto, formNfe:tabView:dadosImpostos, formNfe:tabView:dadosProduto, formNfe:tabView:dadosTotais" />
								</p:column>

								<f:facet name="footer">
									<div align="left"></div>
								</f:facet>

							</p:dataTable>
						</p:panel>
					</div>
				</p:tab>
				<p:tab title="Transportadora">
					<div class="ui-fluid">
						<p:panel header="Dados da Transportadora" id="dadosTransportadora">
							<p:messages />
							<h:panelGrid columns="4" style="width: 90%"
										 columnClasses="rotulo,campo,rotulo">
								<p:outputLabel value="Tipo do Frete:" for="tipoFrete" />
								<p:selectOneMenu id="tipoFrete"
												 value="#{notaFiscalFormularioBean.notaFiscal.modeloFrete}">
									<f:selectItem itemValue="0" itemLabel="0-Por conta do empresa" />
									<f:selectItem itemValue="1"
												  itemLabel="1-Por conta do destinatário/remetente" />
									<f:selectItem itemValue="2"
												  itemLabel="2-Por conta de terceiros" />
									<f:selectItem itemValue="9" itemLabel="9-Sem frete" />
								</p:selectOneMenu>

								<p:outputLabel value="" />
								<p:outputLabel value="" />

								<p:outputLabel value="Transportadora:" for="nomeTransportadora" />
								<h:panelGroup style="display:flex;">
									<p:inputText
											value="#{notaFiscalFormularioBean.notaFiscal.nomeTransportadora}"
											style="opacity: 1;" id="nomeTransportadora" disabled="true" />
									<p:commandButton icon="fa fa-search"
													 styleClass="ui-priority-primary" style="max-width: 30px"
													 type="button" onclick="PF('transportadoraDialog').show();" />
								</h:panelGroup>

								<p:outputLabel value="" />
								<p:outputLabel value="" />

								<p:outputLabel id="cpfCnpjLabelTransportadora"
											   value="#{notaFiscalFormularioBean.notaFiscal.tipoCadastroTransportadora == '1' ? 'CNPJ:' : 'CPF:'}"
											   for="cpfCnpjTransportadora" />
								<p:inputMask id="cpfCnpjTransportadora"
											 mask="#{notaFiscalFormularioBean.notaFiscal.tipoCadastroTransportadora == '1' ? '99.999.999/9999-99' : '999.999.999-99'}"
											 value="#{notaFiscalFormularioBean.notaFiscal.cpfCnpjTransportadora}"
											 immediate="true" style="opacity: 1;" disabled="true" />

								<p:outputLabel value="Inscrição Estadual:" for="ie" />
								<p:inputText id="ie"
											 value="#{notaFiscalFormularioBean.notaFiscal.inscricaoEstadualTransportadora}" />

								<p:outputLabel value="Estado:" for="estadoTransportadora" />
								<p:inputText id="estadoTransportadora"
											 value="#{notaFiscalFormularioBean.notaFiscal.estadoTransportadora}" />

								<p:outputLabel value="Cidade:" for="cidadeTransportadora" />
								<p:inputText id="cidadeTransportadora"
											 value="#{notaFiscalFormularioBean.notaFiscal.cidadeTransportadora}" />

								<p:outputLabel value="Endereço:" for="enderecoTransportadora" />
								<p:inputText id="enderecoTransportadora"
											 value="#{notaFiscalFormularioBean.notaFiscal.enderecoTransportadora}" />
							</h:panelGrid>
						</p:panel>
					</div>
				</p:tab>
				<p:tab title="Subtotal">
					<p:panel header="Impostos" id="dadosImpostos" >
						<h:panelGrid columns="6"
									 columnClasses="rotulo, campoNfe, rotulo, campoNfe, rotulo, campoNfe"
									 layout="grid" style="width: 100%; ">
							<p:outputLabel value="ICMS:" for="vIcms" />
							<p:inputNumber id="vIcms" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalIcms}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Base ICMS:" for="bIcms" />
							<p:inputNumber id="bIcms" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalBaseIcms}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="ICMS ST:" for="vIcmsSt" />
							<p:inputNumber id="vIcmsSt" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalIcmsS}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Base ICMS ST:" for="bIcmsSt" />
							<p:inputNumber id="bIcmsSt" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalBaseIcmsSt}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Valor PIS:" for="vPis" />
							<p:inputNumber id="vPis" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalPis}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Valor Cofins:" for="vCofins" />
							<p:inputNumber id="vCofins" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalCofins}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Valor IPI:" for="vIpi" />
							<p:inputNumber id="vIpi" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalIpi}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Funrural:" for="funrural" />
							<p:inputNumber id="funrural" disabled="true" value="0"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Valor de Tributos (Aproximados):"
										   for="tribAprox" />
							<p:inputNumber id="tribAprox" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalImpostosAproximados}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />
						</h:panelGrid>
					</p:panel>
					<p:panel header="Totais" id="dadosTotais">
						<h:panelGrid columns="6"
									 columnClasses="rotulo, campoNfe, rotulo, campoNfe, rotulo, campoNfe"
									 layout="grid" style="width: 100%; ">
							<p:outputLabel value="Total dos Produtos:" for="vTotalProduto" />
							<p:inputNumber id="vTotalProduto" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalProdutos}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Total da Nota Fiscal:"
										   for="vTotalNotaFiscal" />
							<p:inputNumber id="vTotalNotaFiscal" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalNfe}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />

							<p:outputLabel value="Total de Descontos:" for="vTotalDesconto" />
							<p:inputNumber id="vTotalDesconto" disabled="true"
										   value="#{notaFiscalFormularioBean.notaFiscal.valorTotalDesconto}"
										   symbol="R$ " decimalSeparator="," thousandSeparator="."
										   decimalPlaces="2" />
						</h:panelGrid>
					</p:panel>
				</p:tab>
				<p:tab title="Dados adicionais">
					<p:panel header="Informações Complementares">
						<div class="ui-fluid">
							<p:inputTextarea id="ifoComplementar" rows="8" autoResize="true"
											 value="#{notaFiscalFormularioBean.notaFiscal.informacoesComplementare}" />
						</div>
					</p:panel>
					<p:panel id="documentosReferenciados"
							 header="Documentos Referenciados">
						<h:panelGrid columns="2" columnClasses="rotulo">
							<p:outputLabel value="Tipo de Documento:" />
							<p:selectOneMenu id="tipoDocumentoReferenciado"
											 style="width: 616px"
											 value="#{notaFiscalFormularioBean.notaFiscalReferencia.tipoDocumento}">
								<f:selectItem itemLabel="Selecione..." />
								<f:selectItem itemLabel="Cupom Fiscal" itemValue="0" />
								<f:selectItem itemLabel="Nota Fiscal" itemValue="1" />
								<p:ajax update="formNfe:tabView:documentosReferenciados"
										listener="#{notaFiscalFormularioBean.limpaNotaFiscalReferencias()}" />
							</p:selectOneMenu>
						</h:panelGrid>

						<h:panelGrid id="cupomFiscalReferencia" columns="6"
									 columnClasses="rotulo"
									 rendered="#{notaFiscalFormularioBean.notaFiscalReferencia.tipoDocumento.equals('0') }">

							<p:outputLabel for="cooReferencia" value="COO:" />
							<p:inputText id="cooReferencia"
										 value="#{notaFiscalFormularioBean.notaFiscalReferencia.coo}" />

							<p:outputLabel for="pdvReferencia" value="PDV" />
							<p:inputText id="pdvReferencia"
										 value="#{notaFiscalFormularioBean.notaFiscalReferencia.pdv}" />

							<p:outputLabel for="dataReferencia_1" value="Data:" />
							<p:calendar id="dataReferencia_1" locale="pt_BR"
										pattern="dd/MM/yyyy"
										value="#{notaFiscalFormularioBean.notaFiscalReferencia.data}" />

							<p:outputLabel for="serieEcfReferencia" value="Série ECF:" />
							<p:inputText id="serieEcfReferencia" style="width: 390px;"
										 value="#{notaFiscalFormularioBean.notaFiscalReferencia.ecfSerie}" />

							<p:outputLabel value="" />
							<p:outputLabel value="" />
							<p:outputLabel value="" />
							<p:outputLabel value="" />
							<p:outputLabel value="" />

							<p:commandButton styleClass="ui-priority-primary"
											 value="Incluir documento referenciado"
											 actionListener="#{notaFiscalFormularioBean.incluirNotaFiscalReferenciaCupom()}"
											 process="documentosReferenciados"
											 update="documentosReferenciados" />
						</h:panelGrid>


						<p:dataTable
								rendered="#{notaFiscalFormularioBean.notaFiscalReferencia.tipoDocumento.equals('0')}"
								value="#{notaFiscalFormularioBean.notaFiscal.notaFiscalReferencias}"
								emptyMessage="Nenhum item adicionado." reflow="true" var="dados"
								style="margin-top: 15px" id="tabelaDocumentoReferenciadoChave"
								rowKey="#{dados.coo}">

							<p:column headerText="COO" style="width:20%">
								<h:outputText value="#{dados.coo}" />
							</p:column>

							<p:column headerText="PDV" style="width:20%">
								<h:outputText value="#{dados.pdv}" />
							</p:column>

							<p:column headerText="Data" style="width:10%">
								<p:outputLabel value="#{dados.data}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</p:outputLabel>
							</p:column>

							<p:column headerText="Série ECF" style="width:30%">
								<h:outputText value="#{dados.ecfSerie}" />
							</p:column>

							<p:column headerText="Ações" style="width:5%">
								<p:commandButton
										actionListener="#{notaFiscalFormularioBean.editarNotaFiscalReferencia(dados)}"
										update="formNfe:tabView:documentosReferenciados"
										process="formNfe:tabView:documentosReferenciados"
										icon="fa fa-edit" />
								<p:commandButton
										actionListener="#{notaFiscalFormularioBean.removerNotaFiscalReferencia(dados)}"
										update="formNfe:tabView:documentosReferenciados"
										process="formNfe:tabView:documentosReferenciados"
										icon="ui-icon-trash" />
							</p:column>
						</p:dataTable>

						<h:panelGrid id="documentoEletronicoReferencia" columns="2"
									 columnClasses="rotulo"
									 rendered="#{notaFiscalFormularioBean.notaFiscalReferencia.tipoDocumento.equals('1')}">
							<p:outputLabel for="numeroReferencia" value="Chave:" />
							<p:inputText id="numeroReferencia" style="width: 450px;"
										 value="#{notaFiscalFormularioBean.notaFiscalReferencia.chave}" />
							<p:outputLabel value="" />
							<p:commandButton styleClass="ui-priority-primary"
											 value="Incluir documento referenciado"
											 actionListener="#{notaFiscalFormularioBean.incluirNotaFiscalReferenciaNota()}"
											 process="documentosReferenciados"
											 update="documentosReferenciados" />
						</h:panelGrid>
						
						<p:dataTable
								rendered="#{notaFiscalFormularioBean.notaFiscalReferencia.tipoDocumento.equals('1')}"
								value="#{notaFiscalFormularioBean.notaFiscal.notaFiscalReferencias}"
								emptyMessage="Nenhum item adicionado." reflow="true" var="dados"
								style="margin-top: 15px" id="tabelaDocumentoReferenciadoNota"
								rowKey="#{dados.chave}">

							<p:column headerText="Chave" style="width:20%">
								<h:outputText value="#{dados.chave}" />
							</p:column>

							<p:column headerText="Ações" style="width:5%">
								<p:commandButton
										actionListener="#{notaFiscalFormularioBean.editarNotaFiscalReferencia(dados)}"
										update="formNfe:tabView:documentosReferenciados"
										process="formNfe:tabView:documentosReferenciados"
										icon="fa fa-edit" />
								<p:commandButton
										actionListener="#{notaFiscalFormularioBean.removerNotaFiscalReferencia(dados)}"
										update="formNfe:tabView:documentosReferenciados"
										process="formNfe:tabView:documentosReferenciados"
										icon="ui-icon-trash" />
							</p:column>
						</p:dataTable>
					</p:panel>
				</p:tab>
			</p:tabView>
			
			<p:toolbar>
				<f:facet name="left">
					<p:commandButton styleClass="ui-priority-primary" process="@form"
									 style="margin-top: 3px; margin-bottom: 3px; margin-left: 7px"
									 value="Salvar" icon="fa fa-floppy-o" action="#{notaFiscalFormularioBean.salvar()}"
									 onclick="PF('salvarCadastro').disable();" widgetVar="salvarCadastro" />
				</f:facet>
				<f:facet name="right">
					<p:button outcome="Saida" value="Cancelar" icon="fa fa-reply" styleClass="ui-priority-primary"
							  style="margin-top: 3px; margin-bottom: 3px; margin-left: -7px" />
				</f:facet>
			</p:toolbar>
		</h:form>


		<p:dialog widgetVar="entidadeDialog" modal="true" height="450"
				  width="850" resizable="false">
			<h:form>
				<p:dataTable value="#{notaFiscalFormularioBean.entidades}"
							 widgetVar="listaEntidades" selectionMode="single"
							 emptyMessage="Nenhum item adicionado" reflow="true" var="dados"
							 id="dadosEntidadeTabela" multiViewState="true" rowKey="#{dados.id}"
							 selection="#{notaFiscalFormularioBean.notaFiscal.entidade}"
							 filteredValue="#{notaFiscalFormularioBean.entidadesFiltro}"
							 rows="10" paginator="true"
							 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							 rowsPerPageTemplate="10,20,30" paginatorPosition="top">

					<f:facet name="header">
						<div align="left">
							<p:outputPanel style="aling:left">
                                    <p:outputLabel value="Pesquisar: " for="globalFilter" />
								<p:inputText id="globalFilter"
											 onkeyup="PF('listaEntidades').filter()" />
								<p:button icon="fa fa-refresh" style="float:right"
										  styleClass="ui-priority-primary" />
							</p:outputPanel>
						</div>
					</f:facet>

					<p:ajax event="rowSelect" process="dadosEntidadeTabela"
							update="dadosEntidadeTabela" />

					<p:column headerText="Nome" filterBy="#{dados.nome}"
							  filterStyle="display:none">
						<h:outputText value="#{dados.nome}" />
					</p:column>

					<f:facet name="footer">
						<div align="left">
							<p:commandButton value="Selecionar" styleClass="ui-priority-primary"
											 action="#{notaFiscalFormularioBean.carregaDadosDaEntidade()}"
											 oncomplete="PF('entidadeDialog').hide()"
											 update="formNfe:tabView:dadosEntidade" />
						</div>
					</f:facet>

				</p:dataTable>
			</h:form>
		</p:dialog>

		<p:dialog widgetVar="produtoDialog" modal="true" height="450"
				  width="850" resizable="false">
			<h:form>
				<p:dataTable value="#{notaFiscalFormularioBean.produtos}"
							 widgetVar="listaProdutos" selectionMode="single"
							 emptyMessage="Nenhum item adicionado" reflow="true" var="dados"
							 id="dadosProdutoTabela" multiViewState="true" rowKey="#{dados.id}"
							 selection="#{notaFiscalFormularioBean.notaFiscalItem.produto}"
							 filteredValue="#{notaFiscalFormularioBean.produtosFiltro}"
							 rows="10" paginator="true"
							 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							 rowsPerPageTemplate="10,20,30" paginatorPosition="top">

					<f:facet name="header">
						<div align="left">
							<p:outputPanel style="aling:left">
								<p:outputLabel value="Pesquisar: " for="globalFilter" />
								<p:inputText id="globalFilter"
											 onkeyup="PF('listaProdutos').filter()" />
								<p:button icon="fa fa-refresh" style="float:right"
										  styleClass="ui-priority-primary" />
							</p:outputPanel>
						</div>
					</f:facet>

					<p:ajax event="rowSelect" process="dadosProdutoTabela"
							update="dadosProdutoTabela" />

					<p:column headerText="Nome" filterBy="#{dados.descricao}"
							  filterStyle="display:none">
						<h:outputText value="#{dados.descricao}" />
					</p:column>

					<f:facet name="footer">
						<div align="left">
							<p:commandButton value="Selecionar"
											 styleClass="ui-priority-primary"
											 action="#{notaFiscalFormularioBean.carregaDadosDoProduto()}"
											 oncomplete="PF('produtoDialog').hide()"
											 update="formNfe:tabView:dadosProduto" />
						</div>
					</f:facet>
				</p:dataTable>
			</h:form>
		</p:dialog>


		<p:dialog widgetVar="transportadoraDialog" modal="true" height="450"
				  width="850" resizable="false">
			<h:form>
				<p:dataTable value="#{notaFiscalFormularioBean.transportadoras}"
							 widgetVar="listaTransportadoras" selectionMode="single"
							 emptyMessage="Nenhum item adicionado" reflow="true" var="dados"
							 id="dadosTabela" multiViewState="true" rowKey="#{dados.id}"
							 selection="#{notaFiscalFormularioBean.notaFiscal.transportadora}"
							 filteredValue="#{notaFiscalFormularioBean.transportadorasFiltro}"
							 rows="10" paginator="true"
							 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							 rowsPerPageTemplate="10,20,30" paginatorPosition="top">

					<f:facet name="header">
						<div align="left">
							<p:outputPanel style="aling:left">
								<p:outputLabel value="Pesquisar: " for="globalFilter" />
								<p:inputText id="globalFilter"
											 onkeyup="PF('listaTransportadoras').filter()" />
								<p:button icon="fa fa-refresh" style="float:right"
										  styleClass="ui-priority-primary" />
							</p:outputPanel>
						</div>
					</f:facet>

					<p:ajax event="rowSelect" process="dadosTabela"
							update="dadosTabela" />

					<p:column headerText="Nome" filterBy="#{dados.nome}"
							  filterStyle="display:none">
						<h:outputText value="#{dados.nome}" />
					</p:column>

					<f:facet name="footer">
						<div align="left">
							<p:commandButton value="Selecionar"
											 styleClass="ui-priority-primary"
											 action="#{notaFiscalFormularioBean.carregaDadosDaTransportadora()}"
											 oncomplete="PF('transportadoraDialog').hide()"
											 update="formNfe:tabView:dadosTransportadora" />
						</div>
					</f:facet>
				</p:dataTable>
			</h:form>
		</p:dialog>


	</ui:define>

</ui:composition>